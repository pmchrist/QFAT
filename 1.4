{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "5e9b4698",
   "metadata": {},
   "source": [
    "# Reading in Data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b62fb0ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>APMOLLER_B</th>\n",
       "      <th>APMOLLER_A</th>\n",
       "      <th>INDUSTRIVARDEN_A</th>\n",
       "      <th>INDUSTRIVARDEN_C</th>\n",
       "      <th>INVESTOR_B</th>\n",
       "      <th>INVESTOR_A</th>\n",
       "      <th>SVENSKAHANDBKN_A</th>\n",
       "      <th>SVENSKAHANDBKN_B</th>\n",
       "      <th>VOLVO_B</th>\n",
       "      <th>VOLVO_A</th>\n",
       "      <th>VW_PREF</th>\n",
       "      <th>VW</th>\n",
       "      <th>HYUNDAI</th>\n",
       "      <th>HYUNDAI_PREF</th>\n",
       "      <th>STORAENSO_R</th>\n",
       "      <th>STORAENSO_A</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>08.09.2004</td>\n",
       "      <td>972.16</td>\n",
       "      <td>1156.58</td>\n",
       "      <td>367.23</td>\n",
       "      <td>68.36</td>\n",
       "      <td>184.06</td>\n",
       "      <td>520.21</td>\n",
       "      <td>617.49</td>\n",
       "      <td>147.56</td>\n",
       "      <td>653.62</td>\n",
       "      <td>622.63</td>\n",
       "      <td>198.02</td>\n",
       "      <td>1277.31</td>\n",
       "      <td>1.95</td>\n",
       "      <td>0.13</td>\n",
       "      <td>581.42</td>\n",
       "      <td>434.37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>09.09.2004</td>\n",
       "      <td>982.06</td>\n",
       "      <td>1168.55</td>\n",
       "      <td>367.22</td>\n",
       "      <td>68.33</td>\n",
       "      <td>183.52</td>\n",
       "      <td>516.94</td>\n",
       "      <td>615.66</td>\n",
       "      <td>147.61</td>\n",
       "      <td>649.84</td>\n",
       "      <td>618.80</td>\n",
       "      <td>199.28</td>\n",
       "      <td>1290.60</td>\n",
       "      <td>1.97</td>\n",
       "      <td>0.14</td>\n",
       "      <td>580.58</td>\n",
       "      <td>435.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10.09.2004</td>\n",
       "      <td>1003.93</td>\n",
       "      <td>1194.89</td>\n",
       "      <td>372.99</td>\n",
       "      <td>69.15</td>\n",
       "      <td>186.94</td>\n",
       "      <td>528.37</td>\n",
       "      <td>623.04</td>\n",
       "      <td>148.38</td>\n",
       "      <td>651.38</td>\n",
       "      <td>621.27</td>\n",
       "      <td>203.79</td>\n",
       "      <td>1321.48</td>\n",
       "      <td>2.04</td>\n",
       "      <td>0.15</td>\n",
       "      <td>586.82</td>\n",
       "      <td>444.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>13.09.2004</td>\n",
       "      <td>1001.90</td>\n",
       "      <td>1200.88</td>\n",
       "      <td>375.40</td>\n",
       "      <td>69.67</td>\n",
       "      <td>186.12</td>\n",
       "      <td>526.03</td>\n",
       "      <td>626.47</td>\n",
       "      <td>150.21</td>\n",
       "      <td>667.17</td>\n",
       "      <td>635.77</td>\n",
       "      <td>207.63</td>\n",
       "      <td>1352.07</td>\n",
       "      <td>2.10</td>\n",
       "      <td>0.15</td>\n",
       "      <td>582.13</td>\n",
       "      <td>442.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14.09.2004</td>\n",
       "      <td>1007.05</td>\n",
       "      <td>1207.10</td>\n",
       "      <td>377.91</td>\n",
       "      <td>69.61</td>\n",
       "      <td>186.68</td>\n",
       "      <td>527.64</td>\n",
       "      <td>626.31</td>\n",
       "      <td>150.17</td>\n",
       "      <td>666.70</td>\n",
       "      <td>635.23</td>\n",
       "      <td>207.35</td>\n",
       "      <td>1352.10</td>\n",
       "      <td>2.11</td>\n",
       "      <td>0.15</td>\n",
       "      <td>577.88</td>\n",
       "      <td>445.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2604</th>\n",
       "      <td>02.09.2014</td>\n",
       "      <td>2065.22</td>\n",
       "      <td>2421.24</td>\n",
       "      <td>1144.87</td>\n",
       "      <td>221.19</td>\n",
       "      <td>919.40</td>\n",
       "      <td>2590.13</td>\n",
       "      <td>2259.17</td>\n",
       "      <td>524.42</td>\n",
       "      <td>1613.98</td>\n",
       "      <td>1623.33</td>\n",
       "      <td>2169.03</td>\n",
       "      <td>9020.38</td>\n",
       "      <td>11.24</td>\n",
       "      <td>1.20</td>\n",
       "      <td>595.54</td>\n",
       "      <td>426.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2605</th>\n",
       "      <td>03.09.2014</td>\n",
       "      <td>2081.82</td>\n",
       "      <td>2446.70</td>\n",
       "      <td>1155.81</td>\n",
       "      <td>224.17</td>\n",
       "      <td>924.72</td>\n",
       "      <td>2606.48</td>\n",
       "      <td>2287.47</td>\n",
       "      <td>528.96</td>\n",
       "      <td>1607.85</td>\n",
       "      <td>1615.32</td>\n",
       "      <td>2199.19</td>\n",
       "      <td>9118.42</td>\n",
       "      <td>11.04</td>\n",
       "      <td>1.17</td>\n",
       "      <td>604.71</td>\n",
       "      <td>432.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2606</th>\n",
       "      <td>04.09.2014</td>\n",
       "      <td>2073.96</td>\n",
       "      <td>2445.30</td>\n",
       "      <td>1150.97</td>\n",
       "      <td>223.09</td>\n",
       "      <td>914.58</td>\n",
       "      <td>2574.61</td>\n",
       "      <td>2275.60</td>\n",
       "      <td>526.90</td>\n",
       "      <td>1597.60</td>\n",
       "      <td>1606.93</td>\n",
       "      <td>2211.09</td>\n",
       "      <td>9215.47</td>\n",
       "      <td>11.03</td>\n",
       "      <td>1.15</td>\n",
       "      <td>615.42</td>\n",
       "      <td>444.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2607</th>\n",
       "      <td>05.09.2014</td>\n",
       "      <td>2083.89</td>\n",
       "      <td>2457.51</td>\n",
       "      <td>1128.92</td>\n",
       "      <td>218.77</td>\n",
       "      <td>895.95</td>\n",
       "      <td>2527.36</td>\n",
       "      <td>2230.63</td>\n",
       "      <td>516.30</td>\n",
       "      <td>1569.17</td>\n",
       "      <td>1580.54</td>\n",
       "      <td>2240.91</td>\n",
       "      <td>9316.01</td>\n",
       "      <td>10.77</td>\n",
       "      <td>1.14</td>\n",
       "      <td>618.58</td>\n",
       "      <td>444.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2608</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2609 rows Ã— 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            date  APMOLLER_B  APMOLLER_A  INDUSTRIVARDEN_A  INDUSTRIVARDEN_C  \\\n",
       "0     08.09.2004      972.16     1156.58            367.23             68.36   \n",
       "1     09.09.2004      982.06     1168.55            367.22             68.33   \n",
       "2     10.09.2004     1003.93     1194.89            372.99             69.15   \n",
       "3     13.09.2004     1001.90     1200.88            375.40             69.67   \n",
       "4     14.09.2004     1007.05     1207.10            377.91             69.61   \n",
       "...          ...         ...         ...               ...               ...   \n",
       "2604  02.09.2014     2065.22     2421.24           1144.87            221.19   \n",
       "2605  03.09.2014     2081.82     2446.70           1155.81            224.17   \n",
       "2606  04.09.2014     2073.96     2445.30           1150.97            223.09   \n",
       "2607  05.09.2014     2083.89     2457.51           1128.92            218.77   \n",
       "2608         NaN         NaN         NaN               NaN               NaN   \n",
       "\n",
       "      INVESTOR_B  INVESTOR_A  SVENSKAHANDBKN_A  SVENSKAHANDBKN_B  VOLVO_B  \\\n",
       "0         184.06      520.21            617.49            147.56   653.62   \n",
       "1         183.52      516.94            615.66            147.61   649.84   \n",
       "2         186.94      528.37            623.04            148.38   651.38   \n",
       "3         186.12      526.03            626.47            150.21   667.17   \n",
       "4         186.68      527.64            626.31            150.17   666.70   \n",
       "...          ...         ...               ...               ...      ...   \n",
       "2604      919.40     2590.13           2259.17            524.42  1613.98   \n",
       "2605      924.72     2606.48           2287.47            528.96  1607.85   \n",
       "2606      914.58     2574.61           2275.60            526.90  1597.60   \n",
       "2607      895.95     2527.36           2230.63            516.30  1569.17   \n",
       "2608         NaN         NaN               NaN               NaN      NaN   \n",
       "\n",
       "      VOLVO_A  VW_PREF       VW  HYUNDAI  HYUNDAI_PREF  STORAENSO_R  \\\n",
       "0      622.63   198.02  1277.31     1.95          0.13       581.42   \n",
       "1      618.80   199.28  1290.60     1.97          0.14       580.58   \n",
       "2      621.27   203.79  1321.48     2.04          0.15       586.82   \n",
       "3      635.77   207.63  1352.07     2.10          0.15       582.13   \n",
       "4      635.23   207.35  1352.10     2.11          0.15       577.88   \n",
       "...       ...      ...      ...      ...           ...          ...   \n",
       "2604  1623.33  2169.03  9020.38    11.24          1.20       595.54   \n",
       "2605  1615.32  2199.19  9118.42    11.04          1.17       604.71   \n",
       "2606  1606.93  2211.09  9215.47    11.03          1.15       615.42   \n",
       "2607  1580.54  2240.91  9316.01    10.77          1.14       618.58   \n",
       "2608      NaN      NaN      NaN      NaN           NaN          NaN   \n",
       "\n",
       "      STORAENSO_A  \n",
       "0          434.37  \n",
       "1          435.76  \n",
       "2          444.50  \n",
       "3          442.59  \n",
       "4          445.95  \n",
       "...           ...  \n",
       "2604       426.25  \n",
       "2605       432.50  \n",
       "2606       444.02  \n",
       "2607       444.39  \n",
       "2608          NaN  \n",
       "\n",
       "[2609 rows x 17 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import statsmodels.api as sm\n",
    "from datetime import datetime\n",
    "from matplotlib import pyplot as plt\n",
    "\n",
    "pr = pd.read_csv(\"Pairs_RI.csv\")\n",
    "pr"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "354adb76",
   "metadata": {},
   "source": [
    "# Creating a new DataFrame with only end of year days."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "6fc8b5e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>APMOLLER_B</th>\n",
       "      <th>APMOLLER_A</th>\n",
       "      <th>INDUSTRIVARDEN_A</th>\n",
       "      <th>INDUSTRIVARDEN_C</th>\n",
       "      <th>INVESTOR_B</th>\n",
       "      <th>INVESTOR_A</th>\n",
       "      <th>SVENSKAHANDBKN_A</th>\n",
       "      <th>SVENSKAHANDBKN_B</th>\n",
       "      <th>VOLVO_B</th>\n",
       "      <th>VOLVO_A</th>\n",
       "      <th>VW_PREF</th>\n",
       "      <th>VW</th>\n",
       "      <th>HYUNDAI</th>\n",
       "      <th>HYUNDAI_PREF</th>\n",
       "      <th>STORAENSO_R</th>\n",
       "      <th>STORAENSO_A</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2004</th>\n",
       "      <td>2004-12-31</td>\n",
       "      <td>1144.92</td>\n",
       "      <td>1385.29</td>\n",
       "      <td>513.52</td>\n",
       "      <td>93.75</td>\n",
       "      <td>229.79</td>\n",
       "      <td>655.89</td>\n",
       "      <td>796.98</td>\n",
       "      <td>191.24</td>\n",
       "      <td>733.20</td>\n",
       "      <td>698.23</td>\n",
       "      <td>246.59</td>\n",
       "      <td>1491.93</td>\n",
       "      <td>2.45</td>\n",
       "      <td>0.17</td>\n",
       "      <td>679.98</td>\n",
       "      <td>518.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2005</th>\n",
       "      <td>2005-12-30</td>\n",
       "      <td>1441.34</td>\n",
       "      <td>1701.95</td>\n",
       "      <td>569.16</td>\n",
       "      <td>106.07</td>\n",
       "      <td>322.83</td>\n",
       "      <td>918.31</td>\n",
       "      <td>786.03</td>\n",
       "      <td>189.27</td>\n",
       "      <td>906.25</td>\n",
       "      <td>874.63</td>\n",
       "      <td>295.29</td>\n",
       "      <td>1791.23</td>\n",
       "      <td>4.45</td>\n",
       "      <td>0.41</td>\n",
       "      <td>623.82</td>\n",
       "      <td>464.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2006</th>\n",
       "      <td>2006-12-29</td>\n",
       "      <td>1329.30</td>\n",
       "      <td>1555.53</td>\n",
       "      <td>852.86</td>\n",
       "      <td>162.31</td>\n",
       "      <td>464.90</td>\n",
       "      <td>1311.52</td>\n",
       "      <td>992.08</td>\n",
       "      <td>242.83</td>\n",
       "      <td>1389.43</td>\n",
       "      <td>1421.20</td>\n",
       "      <td>592.75</td>\n",
       "      <td>3926.61</td>\n",
       "      <td>3.40</td>\n",
       "      <td>0.28</td>\n",
       "      <td>757.04</td>\n",
       "      <td>577.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2007</th>\n",
       "      <td>2007-12-31</td>\n",
       "      <td>1520.12</td>\n",
       "      <td>1842.04</td>\n",
       "      <td>776.10</td>\n",
       "      <td>146.00</td>\n",
       "      <td>442.69</td>\n",
       "      <td>1228.01</td>\n",
       "      <td>1090.97</td>\n",
       "      <td>260.06</td>\n",
       "      <td>1836.04</td>\n",
       "      <td>1810.64</td>\n",
       "      <td>1175.99</td>\n",
       "      <td>8009.18</td>\n",
       "      <td>3.64</td>\n",
       "      <td>0.25</td>\n",
       "      <td>741.03</td>\n",
       "      <td>548.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2008</th>\n",
       "      <td>2008-12-31</td>\n",
       "      <td>757.66</td>\n",
       "      <td>932.96</td>\n",
       "      <td>336.29</td>\n",
       "      <td>59.82</td>\n",
       "      <td>297.83</td>\n",
       "      <td>818.80</td>\n",
       "      <td>586.49</td>\n",
       "      <td>138.21</td>\n",
       "      <td>629.18</td>\n",
       "      <td>635.79</td>\n",
       "      <td>445.48</td>\n",
       "      <td>12294.24</td>\n",
       "      <td>1.52</td>\n",
       "      <td>0.07</td>\n",
       "      <td>402.63</td>\n",
       "      <td>305.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2009</th>\n",
       "      <td>2009-12-31</td>\n",
       "      <td>1039.20</td>\n",
       "      <td>1221.45</td>\n",
       "      <td>609.91</td>\n",
       "      <td>116.31</td>\n",
       "      <td>389.38</td>\n",
       "      <td>1105.91</td>\n",
       "      <td>1104.69</td>\n",
       "      <td>263.80</td>\n",
       "      <td>1039.76</td>\n",
       "      <td>1023.71</td>\n",
       "      <td>800.87</td>\n",
       "      <td>3917.04</td>\n",
       "      <td>5.10</td>\n",
       "      <td>0.27</td>\n",
       "      <td>384.47</td>\n",
       "      <td>340.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2010</th>\n",
       "      <td>2010-12-31</td>\n",
       "      <td>1348.33</td>\n",
       "      <td>1598.91</td>\n",
       "      <td>908.61</td>\n",
       "      <td>183.13</td>\n",
       "      <td>460.63</td>\n",
       "      <td>1275.55</td>\n",
       "      <td>1283.03</td>\n",
       "      <td>304.50</td>\n",
       "      <td>2129.51</td>\n",
       "      <td>2049.73</td>\n",
       "      <td>1441.22</td>\n",
       "      <td>5192.57</td>\n",
       "      <td>7.56</td>\n",
       "      <td>0.40</td>\n",
       "      <td>586.83</td>\n",
       "      <td>443.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2011</th>\n",
       "      <td>2011-12-30</td>\n",
       "      <td>1002.02</td>\n",
       "      <td>1154.94</td>\n",
       "      <td>667.88</td>\n",
       "      <td>129.32</td>\n",
       "      <td>416.86</td>\n",
       "      <td>1147.42</td>\n",
       "      <td>1106.32</td>\n",
       "      <td>260.72</td>\n",
       "      <td>1357.00</td>\n",
       "      <td>1357.56</td>\n",
       "      <td>1341.72</td>\n",
       "      <td>5008.73</td>\n",
       "      <td>9.22</td>\n",
       "      <td>0.43</td>\n",
       "      <td>352.14</td>\n",
       "      <td>281.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2012</th>\n",
       "      <td>2012-12-31</td>\n",
       "      <td>1166.45</td>\n",
       "      <td>1338.56</td>\n",
       "      <td>936.30</td>\n",
       "      <td>187.28</td>\n",
       "      <td>607.86</td>\n",
       "      <td>1702.56</td>\n",
       "      <td>1567.77</td>\n",
       "      <td>360.82</td>\n",
       "      <td>1742.26</td>\n",
       "      <td>1739.73</td>\n",
       "      <td>2088.43</td>\n",
       "      <td>8242.78</td>\n",
       "      <td>10.27</td>\n",
       "      <td>0.53</td>\n",
       "      <td>428.95</td>\n",
       "      <td>338.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2013</th>\n",
       "      <td>2013-12-31</td>\n",
       "      <td>1732.72</td>\n",
       "      <td>2011.87</td>\n",
       "      <td>1168.67</td>\n",
       "      <td>224.55</td>\n",
       "      <td>832.08</td>\n",
       "      <td>2324.75</td>\n",
       "      <td>2243.92</td>\n",
       "      <td>517.18</td>\n",
       "      <td>1734.95</td>\n",
       "      <td>1721.87</td>\n",
       "      <td>2651.64</td>\n",
       "      <td>10667.55</td>\n",
       "      <td>11.37</td>\n",
       "      <td>0.98</td>\n",
       "      <td>659.39</td>\n",
       "      <td>474.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2014</th>\n",
       "      <td>2014-05-09</td>\n",
       "      <td>2083.89</td>\n",
       "      <td>2457.51</td>\n",
       "      <td>1128.92</td>\n",
       "      <td>218.77</td>\n",
       "      <td>895.95</td>\n",
       "      <td>2527.36</td>\n",
       "      <td>2230.63</td>\n",
       "      <td>516.30</td>\n",
       "      <td>1569.17</td>\n",
       "      <td>1580.54</td>\n",
       "      <td>2240.91</td>\n",
       "      <td>9316.01</td>\n",
       "      <td>10.77</td>\n",
       "      <td>1.14</td>\n",
       "      <td>618.58</td>\n",
       "      <td>444.39</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           date  APMOLLER_B  APMOLLER_A  INDUSTRIVARDEN_A  INDUSTRIVARDEN_C  \\\n",
       "date                                                                          \n",
       "2004 2004-12-31     1144.92     1385.29            513.52             93.75   \n",
       "2005 2005-12-30     1441.34     1701.95            569.16            106.07   \n",
       "2006 2006-12-29     1329.30     1555.53            852.86            162.31   \n",
       "2007 2007-12-31     1520.12     1842.04            776.10            146.00   \n",
       "2008 2008-12-31      757.66      932.96            336.29             59.82   \n",
       "2009 2009-12-31     1039.20     1221.45            609.91            116.31   \n",
       "2010 2010-12-31     1348.33     1598.91            908.61            183.13   \n",
       "2011 2011-12-30     1002.02     1154.94            667.88            129.32   \n",
       "2012 2012-12-31     1166.45     1338.56            936.30            187.28   \n",
       "2013 2013-12-31     1732.72     2011.87           1168.67            224.55   \n",
       "2014 2014-05-09     2083.89     2457.51           1128.92            218.77   \n",
       "\n",
       "      INVESTOR_B  INVESTOR_A  SVENSKAHANDBKN_A  SVENSKAHANDBKN_B  VOLVO_B  \\\n",
       "date                                                                        \n",
       "2004      229.79      655.89            796.98            191.24   733.20   \n",
       "2005      322.83      918.31            786.03            189.27   906.25   \n",
       "2006      464.90     1311.52            992.08            242.83  1389.43   \n",
       "2007      442.69     1228.01           1090.97            260.06  1836.04   \n",
       "2008      297.83      818.80            586.49            138.21   629.18   \n",
       "2009      389.38     1105.91           1104.69            263.80  1039.76   \n",
       "2010      460.63     1275.55           1283.03            304.50  2129.51   \n",
       "2011      416.86     1147.42           1106.32            260.72  1357.00   \n",
       "2012      607.86     1702.56           1567.77            360.82  1742.26   \n",
       "2013      832.08     2324.75           2243.92            517.18  1734.95   \n",
       "2014      895.95     2527.36           2230.63            516.30  1569.17   \n",
       "\n",
       "      VOLVO_A  VW_PREF        VW  HYUNDAI  HYUNDAI_PREF  STORAENSO_R  \\\n",
       "date                                                                   \n",
       "2004   698.23   246.59   1491.93     2.45          0.17       679.98   \n",
       "2005   874.63   295.29   1791.23     4.45          0.41       623.82   \n",
       "2006  1421.20   592.75   3926.61     3.40          0.28       757.04   \n",
       "2007  1810.64  1175.99   8009.18     3.64          0.25       741.03   \n",
       "2008   635.79   445.48  12294.24     1.52          0.07       402.63   \n",
       "2009  1023.71   800.87   3917.04     5.10          0.27       384.47   \n",
       "2010  2049.73  1441.22   5192.57     7.56          0.40       586.83   \n",
       "2011  1357.56  1341.72   5008.73     9.22          0.43       352.14   \n",
       "2012  1739.73  2088.43   8242.78    10.27          0.53       428.95   \n",
       "2013  1721.87  2651.64  10667.55    11.37          0.98       659.39   \n",
       "2014  1580.54  2240.91   9316.01    10.77          1.14       618.58   \n",
       "\n",
       "      STORAENSO_A  \n",
       "date               \n",
       "2004       518.22  \n",
       "2005       464.92  \n",
       "2006       577.05  \n",
       "2007       548.51  \n",
       "2008       305.74  \n",
       "2009       340.62  \n",
       "2010       443.59  \n",
       "2011       281.19  \n",
       "2012       338.14  \n",
       "2013       474.69  \n",
       "2014       444.39  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pr['date'] = pd.to_datetime(pr['date'])\n",
    "\n",
    "eoy = pd.DataFrame()\n",
    "\n",
    "eoy = pr.groupby(pd.DatetimeIndex(pr.date).to_period('Y')).nth(-1)\n",
    "\n",
    "eoy"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ffb717b7",
   "metadata": {},
   "source": [
    "# Shorts and Longs for the stock pairs."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b8a0b556",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>APMOLLER S</th>\n",
       "      <th>APMOLLER L</th>\n",
       "      <th>APMOLLER T</th>\n",
       "      <th>INDUSTRIVARDEN S</th>\n",
       "      <th>INDUSTRIVARDEN L</th>\n",
       "      <th>INDUSTRIVARDEN T</th>\n",
       "      <th>INVESTOR S</th>\n",
       "      <th>INVESTOR L</th>\n",
       "      <th>INVESTOR T</th>\n",
       "      <th>...</th>\n",
       "      <th>VOLVO T</th>\n",
       "      <th>VW S</th>\n",
       "      <th>VW L</th>\n",
       "      <th>VW T</th>\n",
       "      <th>HYUNDAI S</th>\n",
       "      <th>HYUNDAI L</th>\n",
       "      <th>HYUNDAI T</th>\n",
       "      <th>STORAENSO S</th>\n",
       "      <th>STORAENSO L</th>\n",
       "      <th>STORAENSO T</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2005</td>\n",
       "      <td>-0.186057</td>\n",
       "      <td>0.258900</td>\n",
       "      <td>0.072843</td>\n",
       "      <td>-0.097758</td>\n",
       "      <td>0.131413</td>\n",
       "      <td>0.033655</td>\n",
       "      <td>-0.285764</td>\n",
       "      <td>0.404891</td>\n",
       "      <td>0.119127</td>\n",
       "      <td>...</td>\n",
       "      <td>0.061687</td>\n",
       "      <td>-0.167092</td>\n",
       "      <td>0.197494</td>\n",
       "      <td>0.030402</td>\n",
       "      <td>-0.449438</td>\n",
       "      <td>1.411765</td>\n",
       "      <td>0.962327</td>\n",
       "      <td>0.090026</td>\n",
       "      <td>-0.102852</td>\n",
       "      <td>-0.012826</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2006</td>\n",
       "      <td>0.094129</td>\n",
       "      <td>-0.077733</td>\n",
       "      <td>0.016395</td>\n",
       "      <td>-0.332645</td>\n",
       "      <td>0.530216</td>\n",
       "      <td>0.197570</td>\n",
       "      <td>-0.299812</td>\n",
       "      <td>0.440077</td>\n",
       "      <td>0.140264</td>\n",
       "      <td>...</td>\n",
       "      <td>0.277162</td>\n",
       "      <td>-0.543823</td>\n",
       "      <td>1.007349</td>\n",
       "      <td>0.463526</td>\n",
       "      <td>0.308824</td>\n",
       "      <td>-0.317073</td>\n",
       "      <td>-0.008250</td>\n",
       "      <td>-0.175975</td>\n",
       "      <td>0.241181</td>\n",
       "      <td>0.065206</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2007</td>\n",
       "      <td>-0.155540</td>\n",
       "      <td>0.143549</td>\n",
       "      <td>-0.011990</td>\n",
       "      <td>0.098905</td>\n",
       "      <td>-0.100487</td>\n",
       "      <td>-0.001582</td>\n",
       "      <td>0.068004</td>\n",
       "      <td>-0.047774</td>\n",
       "      <td>0.020231</td>\n",
       "      <td>...</td>\n",
       "      <td>0.106350</td>\n",
       "      <td>-0.509736</td>\n",
       "      <td>0.983956</td>\n",
       "      <td>0.474220</td>\n",
       "      <td>-0.065934</td>\n",
       "      <td>-0.107143</td>\n",
       "      <td>-0.173077</td>\n",
       "      <td>0.021605</td>\n",
       "      <td>-0.049458</td>\n",
       "      <td>-0.027853</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2008</td>\n",
       "      <td>0.974404</td>\n",
       "      <td>-0.501579</td>\n",
       "      <td>0.472825</td>\n",
       "      <td>1.307830</td>\n",
       "      <td>-0.590274</td>\n",
       "      <td>0.717556</td>\n",
       "      <td>0.499768</td>\n",
       "      <td>-0.327227</td>\n",
       "      <td>0.172541</td>\n",
       "      <td>...</td>\n",
       "      <td>1.269288</td>\n",
       "      <td>-0.348542</td>\n",
       "      <td>-0.621187</td>\n",
       "      <td>-0.969729</td>\n",
       "      <td>1.394737</td>\n",
       "      <td>-0.720000</td>\n",
       "      <td>0.674737</td>\n",
       "      <td>0.840474</td>\n",
       "      <td>-0.442599</td>\n",
       "      <td>0.397875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2009</td>\n",
       "      <td>-0.236186</td>\n",
       "      <td>0.371591</td>\n",
       "      <td>0.135405</td>\n",
       "      <td>-0.448624</td>\n",
       "      <td>0.944333</td>\n",
       "      <td>0.495709</td>\n",
       "      <td>-0.259614</td>\n",
       "      <td>0.307390</td>\n",
       "      <td>0.047776</td>\n",
       "      <td>...</td>\n",
       "      <td>0.273628</td>\n",
       "      <td>2.138656</td>\n",
       "      <td>0.797769</td>\n",
       "      <td>2.936424</td>\n",
       "      <td>-0.701961</td>\n",
       "      <td>2.857143</td>\n",
       "      <td>2.155182</td>\n",
       "      <td>0.047234</td>\n",
       "      <td>0.114084</td>\n",
       "      <td>0.161318</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2010</td>\n",
       "      <td>-0.236073</td>\n",
       "      <td>0.297469</td>\n",
       "      <td>0.061396</td>\n",
       "      <td>-0.328744</td>\n",
       "      <td>0.574499</td>\n",
       "      <td>0.245755</td>\n",
       "      <td>-0.132994</td>\n",
       "      <td>0.182983</td>\n",
       "      <td>0.049990</td>\n",
       "      <td>...</td>\n",
       "      <td>0.490519</td>\n",
       "      <td>-0.245645</td>\n",
       "      <td>0.799568</td>\n",
       "      <td>0.553923</td>\n",
       "      <td>-0.325397</td>\n",
       "      <td>0.481481</td>\n",
       "      <td>0.156085</td>\n",
       "      <td>-0.344836</td>\n",
       "      <td>0.302302</td>\n",
       "      <td>-0.042534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2011</td>\n",
       "      <td>0.384410</td>\n",
       "      <td>-0.256844</td>\n",
       "      <td>0.127566</td>\n",
       "      <td>0.360439</td>\n",
       "      <td>-0.293835</td>\n",
       "      <td>0.066604</td>\n",
       "      <td>0.111668</td>\n",
       "      <td>-0.095022</td>\n",
       "      <td>0.016646</td>\n",
       "      <td>...</td>\n",
       "      <td>0.231589</td>\n",
       "      <td>0.036704</td>\n",
       "      <td>-0.069039</td>\n",
       "      <td>-0.032335</td>\n",
       "      <td>-0.180043</td>\n",
       "      <td>0.075000</td>\n",
       "      <td>-0.105043</td>\n",
       "      <td>0.666468</td>\n",
       "      <td>-0.366104</td>\n",
       "      <td>0.300364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2012</td>\n",
       "      <td>-0.137177</td>\n",
       "      <td>0.164099</td>\n",
       "      <td>0.026921</td>\n",
       "      <td>-0.286682</td>\n",
       "      <td>0.448191</td>\n",
       "      <td>0.161509</td>\n",
       "      <td>-0.326062</td>\n",
       "      <td>0.458187</td>\n",
       "      <td>0.132125</td>\n",
       "      <td>...</td>\n",
       "      <td>0.064234</td>\n",
       "      <td>-0.392349</td>\n",
       "      <td>0.556532</td>\n",
       "      <td>0.164182</td>\n",
       "      <td>-0.102240</td>\n",
       "      <td>0.232558</td>\n",
       "      <td>0.130319</td>\n",
       "      <td>-0.179065</td>\n",
       "      <td>0.202532</td>\n",
       "      <td>0.023467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2013</td>\n",
       "      <td>-0.334669</td>\n",
       "      <td>0.485464</td>\n",
       "      <td>0.150796</td>\n",
       "      <td>-0.198833</td>\n",
       "      <td>0.199007</td>\n",
       "      <td>0.000174</td>\n",
       "      <td>-0.267637</td>\n",
       "      <td>0.368868</td>\n",
       "      <td>0.101230</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.006053</td>\n",
       "      <td>-0.227303</td>\n",
       "      <td>0.269681</td>\n",
       "      <td>0.042378</td>\n",
       "      <td>-0.096746</td>\n",
       "      <td>0.849057</td>\n",
       "      <td>0.752311</td>\n",
       "      <td>-0.349475</td>\n",
       "      <td>0.403827</td>\n",
       "      <td>0.054352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2014</td>\n",
       "      <td>-0.181338</td>\n",
       "      <td>0.202670</td>\n",
       "      <td>0.021332</td>\n",
       "      <td>0.035211</td>\n",
       "      <td>-0.025740</td>\n",
       "      <td>0.009470</td>\n",
       "      <td>-0.080167</td>\n",
       "      <td>0.076759</td>\n",
       "      <td>-0.003407</td>\n",
       "      <td>...</td>\n",
       "      <td>0.023569</td>\n",
       "      <td>0.145077</td>\n",
       "      <td>-0.154897</td>\n",
       "      <td>-0.009819</td>\n",
       "      <td>0.055710</td>\n",
       "      <td>0.163265</td>\n",
       "      <td>0.218976</td>\n",
       "      <td>0.065974</td>\n",
       "      <td>-0.063831</td>\n",
       "      <td>0.002143</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   date  APMOLLER S  APMOLLER L  APMOLLER T  INDUSTRIVARDEN S  \\\n",
       "0  2005   -0.186057    0.258900    0.072843         -0.097758   \n",
       "1  2006    0.094129   -0.077733    0.016395         -0.332645   \n",
       "2  2007   -0.155540    0.143549   -0.011990          0.098905   \n",
       "3  2008    0.974404   -0.501579    0.472825          1.307830   \n",
       "4  2009   -0.236186    0.371591    0.135405         -0.448624   \n",
       "5  2010   -0.236073    0.297469    0.061396         -0.328744   \n",
       "6  2011    0.384410   -0.256844    0.127566          0.360439   \n",
       "7  2012   -0.137177    0.164099    0.026921         -0.286682   \n",
       "8  2013   -0.334669    0.485464    0.150796         -0.198833   \n",
       "9  2014   -0.181338    0.202670    0.021332          0.035211   \n",
       "\n",
       "   INDUSTRIVARDEN L  INDUSTRIVARDEN T  INVESTOR S  INVESTOR L  INVESTOR T  \\\n",
       "0          0.131413          0.033655   -0.285764    0.404891    0.119127   \n",
       "1          0.530216          0.197570   -0.299812    0.440077    0.140264   \n",
       "2         -0.100487         -0.001582    0.068004   -0.047774    0.020231   \n",
       "3         -0.590274          0.717556    0.499768   -0.327227    0.172541   \n",
       "4          0.944333          0.495709   -0.259614    0.307390    0.047776   \n",
       "5          0.574499          0.245755   -0.132994    0.182983    0.049990   \n",
       "6         -0.293835          0.066604    0.111668   -0.095022    0.016646   \n",
       "7          0.448191          0.161509   -0.326062    0.458187    0.132125   \n",
       "8          0.199007          0.000174   -0.267637    0.368868    0.101230   \n",
       "9         -0.025740          0.009470   -0.080167    0.076759   -0.003407   \n",
       "\n",
       "   ...   VOLVO T      VW S      VW L      VW T  HYUNDAI S  HYUNDAI L  \\\n",
       "0  ...  0.061687 -0.167092  0.197494  0.030402  -0.449438   1.411765   \n",
       "1  ...  0.277162 -0.543823  1.007349  0.463526   0.308824  -0.317073   \n",
       "2  ...  0.106350 -0.509736  0.983956  0.474220  -0.065934  -0.107143   \n",
       "3  ...  1.269288 -0.348542 -0.621187 -0.969729   1.394737  -0.720000   \n",
       "4  ...  0.273628  2.138656  0.797769  2.936424  -0.701961   2.857143   \n",
       "5  ...  0.490519 -0.245645  0.799568  0.553923  -0.325397   0.481481   \n",
       "6  ...  0.231589  0.036704 -0.069039 -0.032335  -0.180043   0.075000   \n",
       "7  ...  0.064234 -0.392349  0.556532  0.164182  -0.102240   0.232558   \n",
       "8  ... -0.006053 -0.227303  0.269681  0.042378  -0.096746   0.849057   \n",
       "9  ...  0.023569  0.145077 -0.154897 -0.009819   0.055710   0.163265   \n",
       "\n",
       "   HYUNDAI T  STORAENSO S  STORAENSO L  STORAENSO T  \n",
       "0   0.962327     0.090026    -0.102852    -0.012826  \n",
       "1  -0.008250    -0.175975     0.241181     0.065206  \n",
       "2  -0.173077     0.021605    -0.049458    -0.027853  \n",
       "3   0.674737     0.840474    -0.442599     0.397875  \n",
       "4   2.155182     0.047234     0.114084     0.161318  \n",
       "5   0.156085    -0.344836     0.302302    -0.042534  \n",
       "6  -0.105043     0.666468    -0.366104     0.300364  \n",
       "7   0.130319    -0.179065     0.202532     0.023467  \n",
       "8   0.752311    -0.349475     0.403827     0.054352  \n",
       "9   0.218976     0.065974    -0.063831     0.002143  \n",
       "\n",
       "[10 rows x 25 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_results = pd.DataFrame()\n",
    "years = ['2005','2006','2007','2008','2009','2010','2011','2012','2013','2014']\n",
    "df_results['date'] = years\n",
    "\n",
    "df_APMOLLER = eoy[['APMOLLER_B', 'APMOLLER_A']].copy()\n",
    "df_INDUSTRIVARDEN = eoy[['INDUSTRIVARDEN_A', 'INDUSTRIVARDEN_C']].copy()\n",
    "df_INVESTOR = eoy[['INVESTOR_B', 'INVESTOR_A']].copy()\n",
    "df_SVENSKAHANDBKN = eoy[['SVENSKAHANDBKN_A', 'SVENSKAHANDBKN_B']].copy()\n",
    "df_VOLVO = eoy[['VOLVO_B', 'VOLVO_A']].copy()\n",
    "df_VW = eoy[['VW_PREF', 'VW']].copy()\n",
    "df_HYUNDAI = eoy[['HYUNDAI', 'HYUNDAI_PREF']].copy()\n",
    "df_STORAENSO = eoy[['STORAENSO_R', 'STORAENSO_A']].copy()\n",
    "\n",
    "short_list = ['APMOLLER S','INDUSTRIVARDEN S','INVESTOR S','SVENSKAHANDBKN S','VOLVO S','VW S','HYUNDAI S','STORAENSO S']\n",
    "long_list = ['APMOLLER L','INDUSTRIVARDEN L','INVESTOR L','SVENSKAHANDBKN L','VOLVO L','VW L','HYUNDAI L','STORAENSO L']\n",
    "total_list = ['APMOLLER T','INDUSTRIVARDEN T','INVESTOR T','SVENSKAHANDBKN T','VOLVO T','VW T','HYUNDAI T','STORAENSO T']\n",
    "df_List = [df_APMOLLER, df_INDUSTRIVARDEN, df_INVESTOR, df_SVENSKAHANDBKN, df_VOLVO, df_VW, df_HYUNDAI, df_STORAENSO]\n",
    "\n",
    "for x in range(len(df_List)):\n",
    "    shortList = []\n",
    "    longList = []\n",
    "    totalList = []\n",
    "    for i in range(10):\n",
    "        if df_List[x].values[i][0] > df_List[x].values[i][1]:\n",
    "            #Short\n",
    "            temp = (df_List[x].values[i][0]) / (df_List[x].values[i+1][0])\n",
    "            answer = 1 * temp\n",
    "            answer = answer - 1\n",
    "            shortList.append(answer)\n",
    "            #Long\n",
    "            temp2 = (df_List[x].values[i+1][1]) / (df_List[x].values[i][1])\n",
    "            answer2 = 1 * temp2\n",
    "            answer2 = answer2 - 1\n",
    "            longList.append(answer2)\n",
    "        else:\n",
    "            #Short\n",
    "            temp = (df_List[x].values[i][1]) / (df_List[x].values[i+1][1])\n",
    "            answer = 1 * temp\n",
    "            answer = answer - 1\n",
    "            shortList.append(answer)\n",
    "            #Long\n",
    "            temp2 = (df_List[x].values[i+1][0]) / (df_List[x].values[i][0])\n",
    "            answer2 = 1 * temp2\n",
    "            answer2 = answer2 - 1\n",
    "            longList.append(answer2)\n",
    "        i = i + 1\n",
    "    df_results[short_list[x]] = shortList\n",
    "    df_results[long_list[x]] = longList\n",
    "    \n",
    "    for i in range(len(longList)):\n",
    "        ans = longList[i] + shortList[i]\n",
    "        totalList.append(ans)\n",
    "    \n",
    "    df_results[total_list[x]] = totalList\n",
    "    \n",
    "    x = x + 1\n",
    "\n",
    "df_results"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f8d0a5d5",
   "metadata": {},
   "source": [
    "# Calculates yearly totals."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "aea49ba6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>APMOLLER S</th>\n",
       "      <th>APMOLLER L</th>\n",
       "      <th>APMOLLER T</th>\n",
       "      <th>INDUSTRIVARDEN S</th>\n",
       "      <th>INDUSTRIVARDEN L</th>\n",
       "      <th>INDUSTRIVARDEN T</th>\n",
       "      <th>INVESTOR S</th>\n",
       "      <th>INVESTOR L</th>\n",
       "      <th>INVESTOR T</th>\n",
       "      <th>...</th>\n",
       "      <th>VW S</th>\n",
       "      <th>VW L</th>\n",
       "      <th>VW T</th>\n",
       "      <th>HYUNDAI S</th>\n",
       "      <th>HYUNDAI L</th>\n",
       "      <th>HYUNDAI T</th>\n",
       "      <th>STORAENSO S</th>\n",
       "      <th>STORAENSO L</th>\n",
       "      <th>STORAENSO T</th>\n",
       "      <th>Totals</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2005</td>\n",
       "      <td>-0.186057</td>\n",
       "      <td>0.258900</td>\n",
       "      <td>0.072843</td>\n",
       "      <td>-0.097758</td>\n",
       "      <td>0.131413</td>\n",
       "      <td>0.033655</td>\n",
       "      <td>-0.285764</td>\n",
       "      <td>0.404891</td>\n",
       "      <td>0.119127</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.167092</td>\n",
       "      <td>0.197494</td>\n",
       "      <td>0.030402</td>\n",
       "      <td>-0.449438</td>\n",
       "      <td>1.411765</td>\n",
       "      <td>0.962327</td>\n",
       "      <td>0.090026</td>\n",
       "      <td>-0.102852</td>\n",
       "      <td>-0.012826</td>\n",
       "      <td>1.270845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2006</td>\n",
       "      <td>0.094129</td>\n",
       "      <td>-0.077733</td>\n",
       "      <td>0.016395</td>\n",
       "      <td>-0.332645</td>\n",
       "      <td>0.530216</td>\n",
       "      <td>0.197570</td>\n",
       "      <td>-0.299812</td>\n",
       "      <td>0.440077</td>\n",
       "      <td>0.140264</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.543823</td>\n",
       "      <td>1.007349</td>\n",
       "      <td>0.463526</td>\n",
       "      <td>0.308824</td>\n",
       "      <td>-0.317073</td>\n",
       "      <td>-0.008250</td>\n",
       "      <td>-0.175975</td>\n",
       "      <td>0.241181</td>\n",
       "      <td>0.065206</td>\n",
       "      <td>1.227162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2007</td>\n",
       "      <td>-0.155540</td>\n",
       "      <td>0.143549</td>\n",
       "      <td>-0.011990</td>\n",
       "      <td>0.098905</td>\n",
       "      <td>-0.100487</td>\n",
       "      <td>-0.001582</td>\n",
       "      <td>0.068004</td>\n",
       "      <td>-0.047774</td>\n",
       "      <td>0.020231</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.509736</td>\n",
       "      <td>0.983956</td>\n",
       "      <td>0.474220</td>\n",
       "      <td>-0.065934</td>\n",
       "      <td>-0.107143</td>\n",
       "      <td>-0.173077</td>\n",
       "      <td>0.021605</td>\n",
       "      <td>-0.049458</td>\n",
       "      <td>-0.027853</td>\n",
       "      <td>0.366609</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2008</td>\n",
       "      <td>0.974404</td>\n",
       "      <td>-0.501579</td>\n",
       "      <td>0.472825</td>\n",
       "      <td>1.307830</td>\n",
       "      <td>-0.590274</td>\n",
       "      <td>0.717556</td>\n",
       "      <td>0.499768</td>\n",
       "      <td>-0.327227</td>\n",
       "      <td>0.172541</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.348542</td>\n",
       "      <td>-0.621187</td>\n",
       "      <td>-0.969729</td>\n",
       "      <td>1.394737</td>\n",
       "      <td>-0.720000</td>\n",
       "      <td>0.674737</td>\n",
       "      <td>0.840474</td>\n",
       "      <td>-0.442599</td>\n",
       "      <td>0.397875</td>\n",
       "      <td>3.126715</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2009</td>\n",
       "      <td>-0.236186</td>\n",
       "      <td>0.371591</td>\n",
       "      <td>0.135405</td>\n",
       "      <td>-0.448624</td>\n",
       "      <td>0.944333</td>\n",
       "      <td>0.495709</td>\n",
       "      <td>-0.259614</td>\n",
       "      <td>0.307390</td>\n",
       "      <td>0.047776</td>\n",
       "      <td>...</td>\n",
       "      <td>2.138656</td>\n",
       "      <td>0.797769</td>\n",
       "      <td>2.936424</td>\n",
       "      <td>-0.701961</td>\n",
       "      <td>2.857143</td>\n",
       "      <td>2.155182</td>\n",
       "      <td>0.047234</td>\n",
       "      <td>0.114084</td>\n",
       "      <td>0.161318</td>\n",
       "      <td>6.645041</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2010</td>\n",
       "      <td>-0.236073</td>\n",
       "      <td>0.297469</td>\n",
       "      <td>0.061396</td>\n",
       "      <td>-0.328744</td>\n",
       "      <td>0.574499</td>\n",
       "      <td>0.245755</td>\n",
       "      <td>-0.132994</td>\n",
       "      <td>0.182983</td>\n",
       "      <td>0.049990</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.245645</td>\n",
       "      <td>0.799568</td>\n",
       "      <td>0.553923</td>\n",
       "      <td>-0.325397</td>\n",
       "      <td>0.481481</td>\n",
       "      <td>0.156085</td>\n",
       "      <td>-0.344836</td>\n",
       "      <td>0.302302</td>\n",
       "      <td>-0.042534</td>\n",
       "      <td>1.530418</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2011</td>\n",
       "      <td>0.384410</td>\n",
       "      <td>-0.256844</td>\n",
       "      <td>0.127566</td>\n",
       "      <td>0.360439</td>\n",
       "      <td>-0.293835</td>\n",
       "      <td>0.066604</td>\n",
       "      <td>0.111668</td>\n",
       "      <td>-0.095022</td>\n",
       "      <td>0.016646</td>\n",
       "      <td>...</td>\n",
       "      <td>0.036704</td>\n",
       "      <td>-0.069039</td>\n",
       "      <td>-0.032335</td>\n",
       "      <td>-0.180043</td>\n",
       "      <td>0.075000</td>\n",
       "      <td>-0.105043</td>\n",
       "      <td>0.666468</td>\n",
       "      <td>-0.366104</td>\n",
       "      <td>0.300364</td>\n",
       "      <td>0.621342</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2012</td>\n",
       "      <td>-0.137177</td>\n",
       "      <td>0.164099</td>\n",
       "      <td>0.026921</td>\n",
       "      <td>-0.286682</td>\n",
       "      <td>0.448191</td>\n",
       "      <td>0.161509</td>\n",
       "      <td>-0.326062</td>\n",
       "      <td>0.458187</td>\n",
       "      <td>0.132125</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.392349</td>\n",
       "      <td>0.556532</td>\n",
       "      <td>0.164182</td>\n",
       "      <td>-0.102240</td>\n",
       "      <td>0.232558</td>\n",
       "      <td>0.130319</td>\n",
       "      <td>-0.179065</td>\n",
       "      <td>0.202532</td>\n",
       "      <td>0.023467</td>\n",
       "      <td>0.792359</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2013</td>\n",
       "      <td>-0.334669</td>\n",
       "      <td>0.485464</td>\n",
       "      <td>0.150796</td>\n",
       "      <td>-0.198833</td>\n",
       "      <td>0.199007</td>\n",
       "      <td>0.000174</td>\n",
       "      <td>-0.267637</td>\n",
       "      <td>0.368868</td>\n",
       "      <td>0.101230</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.227303</td>\n",
       "      <td>0.269681</td>\n",
       "      <td>0.042378</td>\n",
       "      <td>-0.096746</td>\n",
       "      <td>0.849057</td>\n",
       "      <td>0.752311</td>\n",
       "      <td>-0.349475</td>\n",
       "      <td>0.403827</td>\n",
       "      <td>0.054352</td>\n",
       "      <td>1.227209</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2014</td>\n",
       "      <td>-0.181338</td>\n",
       "      <td>0.202670</td>\n",
       "      <td>0.021332</td>\n",
       "      <td>0.035211</td>\n",
       "      <td>-0.025740</td>\n",
       "      <td>0.009470</td>\n",
       "      <td>-0.080167</td>\n",
       "      <td>0.076759</td>\n",
       "      <td>-0.003407</td>\n",
       "      <td>...</td>\n",
       "      <td>0.145077</td>\n",
       "      <td>-0.154897</td>\n",
       "      <td>-0.009819</td>\n",
       "      <td>0.055710</td>\n",
       "      <td>0.163265</td>\n",
       "      <td>0.218976</td>\n",
       "      <td>0.065974</td>\n",
       "      <td>-0.063831</td>\n",
       "      <td>0.002143</td>\n",
       "      <td>0.266519</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   date  APMOLLER S  APMOLLER L  APMOLLER T  INDUSTRIVARDEN S  \\\n",
       "0  2005   -0.186057    0.258900    0.072843         -0.097758   \n",
       "1  2006    0.094129   -0.077733    0.016395         -0.332645   \n",
       "2  2007   -0.155540    0.143549   -0.011990          0.098905   \n",
       "3  2008    0.974404   -0.501579    0.472825          1.307830   \n",
       "4  2009   -0.236186    0.371591    0.135405         -0.448624   \n",
       "5  2010   -0.236073    0.297469    0.061396         -0.328744   \n",
       "6  2011    0.384410   -0.256844    0.127566          0.360439   \n",
       "7  2012   -0.137177    0.164099    0.026921         -0.286682   \n",
       "8  2013   -0.334669    0.485464    0.150796         -0.198833   \n",
       "9  2014   -0.181338    0.202670    0.021332          0.035211   \n",
       "\n",
       "   INDUSTRIVARDEN L  INDUSTRIVARDEN T  INVESTOR S  INVESTOR L  INVESTOR T  \\\n",
       "0          0.131413          0.033655   -0.285764    0.404891    0.119127   \n",
       "1          0.530216          0.197570   -0.299812    0.440077    0.140264   \n",
       "2         -0.100487         -0.001582    0.068004   -0.047774    0.020231   \n",
       "3         -0.590274          0.717556    0.499768   -0.327227    0.172541   \n",
       "4          0.944333          0.495709   -0.259614    0.307390    0.047776   \n",
       "5          0.574499          0.245755   -0.132994    0.182983    0.049990   \n",
       "6         -0.293835          0.066604    0.111668   -0.095022    0.016646   \n",
       "7          0.448191          0.161509   -0.326062    0.458187    0.132125   \n",
       "8          0.199007          0.000174   -0.267637    0.368868    0.101230   \n",
       "9         -0.025740          0.009470   -0.080167    0.076759   -0.003407   \n",
       "\n",
       "   ...      VW S      VW L      VW T  HYUNDAI S  HYUNDAI L  HYUNDAI T  \\\n",
       "0  ... -0.167092  0.197494  0.030402  -0.449438   1.411765   0.962327   \n",
       "1  ... -0.543823  1.007349  0.463526   0.308824  -0.317073  -0.008250   \n",
       "2  ... -0.509736  0.983956  0.474220  -0.065934  -0.107143  -0.173077   \n",
       "3  ... -0.348542 -0.621187 -0.969729   1.394737  -0.720000   0.674737   \n",
       "4  ...  2.138656  0.797769  2.936424  -0.701961   2.857143   2.155182   \n",
       "5  ... -0.245645  0.799568  0.553923  -0.325397   0.481481   0.156085   \n",
       "6  ...  0.036704 -0.069039 -0.032335  -0.180043   0.075000  -0.105043   \n",
       "7  ... -0.392349  0.556532  0.164182  -0.102240   0.232558   0.130319   \n",
       "8  ... -0.227303  0.269681  0.042378  -0.096746   0.849057   0.752311   \n",
       "9  ...  0.145077 -0.154897 -0.009819   0.055710   0.163265   0.218976   \n",
       "\n",
       "   STORAENSO S  STORAENSO L  STORAENSO T    Totals  \n",
       "0     0.090026    -0.102852    -0.012826  1.270845  \n",
       "1    -0.175975     0.241181     0.065206  1.227162  \n",
       "2     0.021605    -0.049458    -0.027853  0.366609  \n",
       "3     0.840474    -0.442599     0.397875  3.126715  \n",
       "4     0.047234     0.114084     0.161318  6.645041  \n",
       "5    -0.344836     0.302302    -0.042534  1.530418  \n",
       "6     0.666468    -0.366104     0.300364  0.621342  \n",
       "7    -0.179065     0.202532     0.023467  0.792359  \n",
       "8    -0.349475     0.403827     0.054352  1.227209  \n",
       "9     0.065974    -0.063831     0.002143  0.266519  \n",
       "\n",
       "[10 rows x 26 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "yearly = []\n",
    "\n",
    "for i in range(len(df_results)):\n",
    "    totals = []\n",
    "    x = 0\n",
    "    for x in range(27):\n",
    "        if x % 3 == 0 and x != 0:\n",
    "            temp = df_results.values[i][x]\n",
    "            totals.append(float(temp))\n",
    "        x = x + 1\n",
    "    summed = sum(totals)\n",
    "    yearly.append(summed)\n",
    "    i = i + 1\n",
    "\n",
    "df_results['Totals'] = yearly\n",
    "\n",
    "df_results"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c199eafa",
   "metadata": {},
   "source": [
    "# Adding research data factors."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a9ded4f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>APMOLLER S</th>\n",
       "      <th>APMOLLER L</th>\n",
       "      <th>APMOLLER T</th>\n",
       "      <th>INDUSTRIVARDEN S</th>\n",
       "      <th>INDUSTRIVARDEN L</th>\n",
       "      <th>INDUSTRIVARDEN T</th>\n",
       "      <th>INVESTOR S</th>\n",
       "      <th>INVESTOR L</th>\n",
       "      <th>INVESTOR T</th>\n",
       "      <th>...</th>\n",
       "      <th>HYUNDAI L</th>\n",
       "      <th>HYUNDAI T</th>\n",
       "      <th>STORAENSO S</th>\n",
       "      <th>STORAENSO L</th>\n",
       "      <th>STORAENSO T</th>\n",
       "      <th>Totals</th>\n",
       "      <th>Mkt-RF</th>\n",
       "      <th>SMB</th>\n",
       "      <th>HML</th>\n",
       "      <th>RF</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2005</td>\n",
       "      <td>-0.186057</td>\n",
       "      <td>0.258900</td>\n",
       "      <td>0.072843</td>\n",
       "      <td>-0.097758</td>\n",
       "      <td>0.131413</td>\n",
       "      <td>0.033655</td>\n",
       "      <td>-0.285764</td>\n",
       "      <td>0.404891</td>\n",
       "      <td>0.119127</td>\n",
       "      <td>...</td>\n",
       "      <td>1.411765</td>\n",
       "      <td>0.962327</td>\n",
       "      <td>0.090026</td>\n",
       "      <td>-0.102852</td>\n",
       "      <td>-0.012826</td>\n",
       "      <td>1.270845</td>\n",
       "      <td>3.09</td>\n",
       "      <td>-2.36</td>\n",
       "      <td>9.41</td>\n",
       "      <td>2.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2006</td>\n",
       "      <td>0.094129</td>\n",
       "      <td>-0.077733</td>\n",
       "      <td>0.016395</td>\n",
       "      <td>-0.332645</td>\n",
       "      <td>0.530216</td>\n",
       "      <td>0.197570</td>\n",
       "      <td>-0.299812</td>\n",
       "      <td>0.440077</td>\n",
       "      <td>0.140264</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.317073</td>\n",
       "      <td>-0.008250</td>\n",
       "      <td>-0.175975</td>\n",
       "      <td>0.241181</td>\n",
       "      <td>0.065206</td>\n",
       "      <td>1.227162</td>\n",
       "      <td>10.60</td>\n",
       "      <td>0.09</td>\n",
       "      <td>11.92</td>\n",
       "      <td>4.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2007</td>\n",
       "      <td>-0.155540</td>\n",
       "      <td>0.143549</td>\n",
       "      <td>-0.011990</td>\n",
       "      <td>0.098905</td>\n",
       "      <td>-0.100487</td>\n",
       "      <td>-0.001582</td>\n",
       "      <td>0.068004</td>\n",
       "      <td>-0.047774</td>\n",
       "      <td>0.020231</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.107143</td>\n",
       "      <td>-0.173077</td>\n",
       "      <td>0.021605</td>\n",
       "      <td>-0.049458</td>\n",
       "      <td>-0.027853</td>\n",
       "      <td>0.366609</td>\n",
       "      <td>1.04</td>\n",
       "      <td>-7.36</td>\n",
       "      <td>-17.28</td>\n",
       "      <td>4.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2008</td>\n",
       "      <td>0.974404</td>\n",
       "      <td>-0.501579</td>\n",
       "      <td>0.472825</td>\n",
       "      <td>1.307830</td>\n",
       "      <td>-0.590274</td>\n",
       "      <td>0.717556</td>\n",
       "      <td>0.499768</td>\n",
       "      <td>-0.327227</td>\n",
       "      <td>0.172541</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.720000</td>\n",
       "      <td>0.674737</td>\n",
       "      <td>0.840474</td>\n",
       "      <td>-0.442599</td>\n",
       "      <td>0.397875</td>\n",
       "      <td>3.126715</td>\n",
       "      <td>-38.34</td>\n",
       "      <td>2.44</td>\n",
       "      <td>1.00</td>\n",
       "      <td>1.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2009</td>\n",
       "      <td>-0.236186</td>\n",
       "      <td>0.371591</td>\n",
       "      <td>0.135405</td>\n",
       "      <td>-0.448624</td>\n",
       "      <td>0.944333</td>\n",
       "      <td>0.495709</td>\n",
       "      <td>-0.259614</td>\n",
       "      <td>0.307390</td>\n",
       "      <td>0.047776</td>\n",
       "      <td>...</td>\n",
       "      <td>2.857143</td>\n",
       "      <td>2.155182</td>\n",
       "      <td>0.047234</td>\n",
       "      <td>0.114084</td>\n",
       "      <td>0.161318</td>\n",
       "      <td>6.645041</td>\n",
       "      <td>28.26</td>\n",
       "      <td>9.18</td>\n",
       "      <td>-9.65</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2010</td>\n",
       "      <td>-0.236073</td>\n",
       "      <td>0.297469</td>\n",
       "      <td>0.061396</td>\n",
       "      <td>-0.328744</td>\n",
       "      <td>0.574499</td>\n",
       "      <td>0.245755</td>\n",
       "      <td>-0.132994</td>\n",
       "      <td>0.182983</td>\n",
       "      <td>0.049990</td>\n",
       "      <td>...</td>\n",
       "      <td>0.481481</td>\n",
       "      <td>0.156085</td>\n",
       "      <td>-0.344836</td>\n",
       "      <td>0.302302</td>\n",
       "      <td>-0.042534</td>\n",
       "      <td>1.530418</td>\n",
       "      <td>17.37</td>\n",
       "      <td>14.19</td>\n",
       "      <td>-5.22</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2011</td>\n",
       "      <td>0.384410</td>\n",
       "      <td>-0.256844</td>\n",
       "      <td>0.127566</td>\n",
       "      <td>0.360439</td>\n",
       "      <td>-0.293835</td>\n",
       "      <td>0.066604</td>\n",
       "      <td>0.111668</td>\n",
       "      <td>-0.095022</td>\n",
       "      <td>0.016646</td>\n",
       "      <td>...</td>\n",
       "      <td>0.075000</td>\n",
       "      <td>-0.105043</td>\n",
       "      <td>0.666468</td>\n",
       "      <td>-0.366104</td>\n",
       "      <td>0.300364</td>\n",
       "      <td>0.621342</td>\n",
       "      <td>0.44</td>\n",
       "      <td>-5.71</td>\n",
       "      <td>-8.42</td>\n",
       "      <td>0.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2012</td>\n",
       "      <td>-0.137177</td>\n",
       "      <td>0.164099</td>\n",
       "      <td>0.026921</td>\n",
       "      <td>-0.286682</td>\n",
       "      <td>0.448191</td>\n",
       "      <td>0.161509</td>\n",
       "      <td>-0.326062</td>\n",
       "      <td>0.458187</td>\n",
       "      <td>0.132125</td>\n",
       "      <td>...</td>\n",
       "      <td>0.232558</td>\n",
       "      <td>0.130319</td>\n",
       "      <td>-0.179065</td>\n",
       "      <td>0.202532</td>\n",
       "      <td>0.023467</td>\n",
       "      <td>0.792359</td>\n",
       "      <td>16.27</td>\n",
       "      <td>-1.40</td>\n",
       "      <td>10.00</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2013</td>\n",
       "      <td>-0.334669</td>\n",
       "      <td>0.485464</td>\n",
       "      <td>0.150796</td>\n",
       "      <td>-0.198833</td>\n",
       "      <td>0.199007</td>\n",
       "      <td>0.000174</td>\n",
       "      <td>-0.267637</td>\n",
       "      <td>0.368868</td>\n",
       "      <td>0.101230</td>\n",
       "      <td>...</td>\n",
       "      <td>0.849057</td>\n",
       "      <td>0.752311</td>\n",
       "      <td>-0.349475</td>\n",
       "      <td>0.403827</td>\n",
       "      <td>0.054352</td>\n",
       "      <td>1.227209</td>\n",
       "      <td>35.20</td>\n",
       "      <td>7.75</td>\n",
       "      <td>2.60</td>\n",
       "      <td>0.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2014</td>\n",
       "      <td>-0.181338</td>\n",
       "      <td>0.202670</td>\n",
       "      <td>0.021332</td>\n",
       "      <td>0.035211</td>\n",
       "      <td>-0.025740</td>\n",
       "      <td>0.009470</td>\n",
       "      <td>-0.080167</td>\n",
       "      <td>0.076759</td>\n",
       "      <td>-0.003407</td>\n",
       "      <td>...</td>\n",
       "      <td>0.163265</td>\n",
       "      <td>0.218976</td>\n",
       "      <td>0.065974</td>\n",
       "      <td>-0.063831</td>\n",
       "      <td>0.002143</td>\n",
       "      <td>0.266519</td>\n",
       "      <td>11.71</td>\n",
       "      <td>-7.86</td>\n",
       "      <td>-1.45</td>\n",
       "      <td>0.02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   date  APMOLLER S  APMOLLER L  APMOLLER T  INDUSTRIVARDEN S  \\\n",
       "0  2005   -0.186057    0.258900    0.072843         -0.097758   \n",
       "1  2006    0.094129   -0.077733    0.016395         -0.332645   \n",
       "2  2007   -0.155540    0.143549   -0.011990          0.098905   \n",
       "3  2008    0.974404   -0.501579    0.472825          1.307830   \n",
       "4  2009   -0.236186    0.371591    0.135405         -0.448624   \n",
       "5  2010   -0.236073    0.297469    0.061396         -0.328744   \n",
       "6  2011    0.384410   -0.256844    0.127566          0.360439   \n",
       "7  2012   -0.137177    0.164099    0.026921         -0.286682   \n",
       "8  2013   -0.334669    0.485464    0.150796         -0.198833   \n",
       "9  2014   -0.181338    0.202670    0.021332          0.035211   \n",
       "\n",
       "   INDUSTRIVARDEN L  INDUSTRIVARDEN T  INVESTOR S  INVESTOR L  INVESTOR T  \\\n",
       "0          0.131413          0.033655   -0.285764    0.404891    0.119127   \n",
       "1          0.530216          0.197570   -0.299812    0.440077    0.140264   \n",
       "2         -0.100487         -0.001582    0.068004   -0.047774    0.020231   \n",
       "3         -0.590274          0.717556    0.499768   -0.327227    0.172541   \n",
       "4          0.944333          0.495709   -0.259614    0.307390    0.047776   \n",
       "5          0.574499          0.245755   -0.132994    0.182983    0.049990   \n",
       "6         -0.293835          0.066604    0.111668   -0.095022    0.016646   \n",
       "7          0.448191          0.161509   -0.326062    0.458187    0.132125   \n",
       "8          0.199007          0.000174   -0.267637    0.368868    0.101230   \n",
       "9         -0.025740          0.009470   -0.080167    0.076759   -0.003407   \n",
       "\n",
       "   ...  HYUNDAI L  HYUNDAI T  STORAENSO S  STORAENSO L  STORAENSO T    Totals  \\\n",
       "0  ...   1.411765   0.962327     0.090026    -0.102852    -0.012826  1.270845   \n",
       "1  ...  -0.317073  -0.008250    -0.175975     0.241181     0.065206  1.227162   \n",
       "2  ...  -0.107143  -0.173077     0.021605    -0.049458    -0.027853  0.366609   \n",
       "3  ...  -0.720000   0.674737     0.840474    -0.442599     0.397875  3.126715   \n",
       "4  ...   2.857143   2.155182     0.047234     0.114084     0.161318  6.645041   \n",
       "5  ...   0.481481   0.156085    -0.344836     0.302302    -0.042534  1.530418   \n",
       "6  ...   0.075000  -0.105043     0.666468    -0.366104     0.300364  0.621342   \n",
       "7  ...   0.232558   0.130319    -0.179065     0.202532     0.023467  0.792359   \n",
       "8  ...   0.849057   0.752311    -0.349475     0.403827     0.054352  1.227209   \n",
       "9  ...   0.163265   0.218976     0.065974    -0.063831     0.002143  0.266519   \n",
       "\n",
       "   Mkt-RF    SMB    HML    RF  \n",
       "0    3.09  -2.36   9.41  2.98  \n",
       "1   10.60   0.09  11.92  4.80  \n",
       "2    1.04  -7.36 -17.28  4.66  \n",
       "3  -38.34   2.44   1.00  1.60  \n",
       "4   28.26   9.18  -9.65  0.10  \n",
       "5   17.37  14.19  -5.22  0.12  \n",
       "6    0.44  -5.71  -8.42  0.04  \n",
       "7   16.27  -1.40  10.00  0.06  \n",
       "8   35.20   7.75   2.60  0.02  \n",
       "9   11.71  -7.86  -1.45  0.02  \n",
       "\n",
       "[10 rows x 30 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('F-F_Research_Data_Factors.CSV')\n",
    "\n",
    "df = df.loc[df[\"January-December\"] >= 2005]\n",
    "df = df.loc[df[\"January-December\"] <= 2014]\n",
    "df = df.rename(columns={\"January-December\": \"date\"})\n",
    "df = df.astype({\"date\":\"int\"})\n",
    "df_results = df_results.astype({\"date\":\"int\"})\n",
    "\n",
    "df_final = pd.merge(df_results, df, on='date')\n",
    "df_final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b7c4c274",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/shanecooke/opt/anaconda3/lib/python3.9/site-packages/scipy/stats/_stats_py.py:1769: UserWarning: kurtosistest only valid for n>=20 ... continuing anyway, n=10\n",
      "  warnings.warn(\"kurtosistest only valid for n>=20 ... continuing \"\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>       <td>APMOLLER T</td>    <th>  R-squared:         </th> <td>   0.675</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.513</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   17.92</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Sat, 04 Mar 2023</td> <th>  Prob (F-statistic):</th>  <td>0.00213</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>19:39:53</td>     <th>  Log-Likelihood:    </th> <td>  11.624</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>    10</td>      <th>  AIC:               </th> <td>  -15.25</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>     6</td>      <th>  BIC:               </th> <td>  -14.04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>         <td>HAC</td>       <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "     <td></td>       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>const</th>  <td>    0.1481</td> <td>    0.011</td> <td>   13.175</td> <td> 0.000</td> <td>    0.126</td> <td>    0.170</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Mkt-RF</th> <td>   -0.0058</td> <td>    0.001</td> <td>   -6.643</td> <td> 0.000</td> <td>   -0.008</td> <td>   -0.004</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>HML</th>    <td>    0.0003</td> <td>    0.001</td> <td>    0.385</td> <td> 0.700</td> <td>   -0.001</td> <td>    0.002</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>SMB</th>    <td>    0.0105</td> <td>    0.002</td> <td>    5.055</td> <td> 0.000</td> <td>    0.006</td> <td>    0.015</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td> 0.250</td> <th>  Durbin-Watson:     </th> <td>   2.181</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.883</td> <th>  Jarque-Bera (JB):  </th> <td>   0.403</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td>-0.099</td> <th>  Prob(JB):          </th> <td>   0.818</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 2.037</td> <th>  Cond. No.          </th> <td>    23.1</td>\n",
       "</tr>\n",
       "</table><br/><br/>Notes:<br/>[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 11 lags and without small sample correction"
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:             APMOLLER T   R-squared:                       0.675\n",
       "Model:                            OLS   Adj. R-squared:                  0.513\n",
       "Method:                 Least Squares   F-statistic:                     17.92\n",
       "Date:                Sat, 04 Mar 2023   Prob (F-statistic):            0.00213\n",
       "Time:                        19:39:53   Log-Likelihood:                 11.624\n",
       "No. Observations:                  10   AIC:                            -15.25\n",
       "Df Residuals:                       6   BIC:                            -14.04\n",
       "Df Model:                           3                                         \n",
       "Covariance Type:                  HAC                                         \n",
       "==============================================================================\n",
       "                 coef    std err          z      P>|z|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "const          0.1481      0.011     13.175      0.000       0.126       0.170\n",
       "Mkt-RF        -0.0058      0.001     -6.643      0.000      -0.008      -0.004\n",
       "HML            0.0003      0.001      0.385      0.700      -0.001       0.002\n",
       "SMB            0.0105      0.002      5.055      0.000       0.006       0.015\n",
       "==============================================================================\n",
       "Omnibus:                        0.250   Durbin-Watson:                   2.181\n",
       "Prob(Omnibus):                  0.883   Jarque-Bera (JB):                0.403\n",
       "Skew:                          -0.099   Prob(JB):                        0.818\n",
       "Kurtosis:                       2.037   Cond. No.                         23.1\n",
       "==============================================================================\n",
       "\n",
       "Notes:\n",
       "[1] Standard Errors are heteroscedasticity and autocorrelation robust (HAC) using 11 lags and without small sample correction\n",
       "\"\"\""
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "x = df_final[['Mkt-RF', 'HML', 'SMB']]\n",
    "x = sm.add_constant(x)\n",
    "reg = sm.OLS(df_final['APMOLLER T'], x).fit(cov_type = 'HAC', cov_kwds = {'maxlags': 11})\n",
    "\n",
    "# summarize the regression result\n",
    "display(reg.summary())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f727e357",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Information Ratio = 6.7798\n",
      "Sharpe Ratio = 2.8003\n"
     ]
    }
   ],
   "source": [
    "# calculate the standard deviation of the residuals (for the information ratio)\n",
    "residuals = reg.resid\n",
    "sigma_epsilon = np.std(residuals)\n",
    "\n",
    "# save regression coefficients\n",
    "coefs = reg.params\n",
    "\n",
    "# Information Ratio (risk-adjusted abnormal returns)\n",
    "print('Information Ratio =', np.round(coefs[0]/sigma_epsilon*np.sqrt(12),4))\n",
    "\n",
    "# Sharpe Ratio (risk-adjusted returns)\n",
    "print('Sharpe Ratio =', np.round(np.mean(df_final['APMOLLER T'])/np.std(df_final['APMOLLER T'])*np.sqrt(12),4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0af9f5ed",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
